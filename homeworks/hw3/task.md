## HW 3

Это задание посвящено эксперементам и улучшению модели, полученной во втором домашнем задании.
Ваша, модель полученная во втором домашнем задании, умеет сегментировать дефекты на изображениях стали.  
Данные устроены так, что каждому пикселю может соотвествовать только один класс дефекта: 0-отсутствие дефекта, 1-4 классы дефектов.


### Задание

Рекомендуется основной код классов датасета и функций обучения, валидации, метрик вынести в отдельный файл.  
В ноутбуке демонстрировать только вызов функций и вывод в виде метрик/графиков.

1. Надо добавить отслеживание метрик в ходе обучения (train) и валидации (val) после каждой эпохи. 
Для этого нужно вручную построить мультиклассовую confusion matrix и посчитать метрики качества:
accuracy, precision, recall, f1-score для каждого класса и микро и макро усреднение. На одном примере убедиться, что метрики совпадают с метриками из пакета sklearn.
Метрики вывести в виде графиков.
2. Провести эксперименты по улучшению модели. Для каждого эксперимента надо вывести на одном графике: train_loss, val_loss, на втором macro precision, recall, f1-score:
    - Попробовать различные оптимизаторы (Adam, SGD, RMSprop)
    - Попробовать различные техники аугментации изображений
    - Попробовать различные техники уменьшения переобучения (dropout, batchnorm, weight decay, l1|l2 normalization)
    - Попробовать различные техники обучения (learning from scratch, transfer learning, fine-tuning). Для этого в качестве предобученной модели надо использовать модели из torchvision или segmentation_models_pytorch.
    - Попробовать различные техники learning rate scheduler (CyclicLR, ReduceLROnPlateau). 
    - Попробовать различные техники улучшения оптимизации (gradient clipping, warm-up)
3. Выбрать лучшую модель и сделать предсказание на тестовом датасете. Сохранить результат в виде масок изображений преобразовнных в формат EncodedPixels.




